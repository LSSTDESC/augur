fiducial_sacc_path : test_test_test_all_y1_mg.sacc

general:
    ignore_scale_cuts : True # If True ignore any values of kmax
    ignore_scale_cuts_likelihood: True # If True ignore any values of kmax when building the likelihood
    bandpower_windows : None #TopHat, None

#TODO: also read in cosmological-model parameters as ParamsMap
cosmo:
    Omega_c : 0.2664  # = 0.3156 - 0.0492
    Omega_b : 0.0492
    h : 0.6727
    n_s : 0.9645
    #A_s : 2.105e-9
    sigma8 : 0.831
    w0: -1.0
    wa: 0.0
    Omega_k: 0.0

    mg_parametrization:
        mu_Sigma:
            mu_0: 0.0
            sigma_0: 0.0
            c1_mg: 1.0
            c2_mg: 1.0
            lambda_mg: 0.0
    transfer_function: boltzmann_isitgr
    matter_power_spectrum: linear
    # If the transfer function is not specified, it defaults to using CAMB

ccl_accuracy:  # Example of a couple of parameters to modify.
    spline_params:  # You can change here any pyccl.spline_params
        K_MAX_SPLINE : 100
    #gsl_params:  # You can change here any pyccl.gsl_params
    #    #INTEGRATION_EPSREL: 1e-4
    #    INTEGRATION_LIMBER_EPSREL: 1e-3

# pt_calculator:
#     type: eulerian_pt_calculator
#     with_NC: False
#     with_IA: True
#     log10k_min: -4
#     log10k_max: 2
#     nk_per_decade: 80
#     with_matter_1loop: False

#for generating the fiducial data veector in generate.py
systematics:
    src0_mult_bias: 0.0
    src1_mult_bias: 0.0
    src2_mult_bias: 0.0
    src3_mult_bias: 0.0
    src4_mult_bias: 0.0
    # Photo-z shifts for sources
    src0_delta_z: 0.0
    src1_delta_z: 0.0
    src2_delta_z: 0.0
    src3_delta_z: 0.0
    src4_delta_z: 0.0 
    # IA parameters for sources
    # ia_a_1: 5.717
    # ia_alphaz_1: -0.47
    # ia_zpiv_1: 0.3
    # ia_a_2: 0.0
    # ia_alphaz_2: 0.0
    # ia_zpiv_2: 0.62
    # ia_a_d: 0.0
    # ia_alphaz_d: 0.0
    # ia_zpiv_d: 0.62   
    ia_bias: 0.0
    alphaz: -0.47
    z_piv: 0.3         

    # Linear Bias for lenses
    lens0_bias: 1.562362
    lens1_bias: 1.732963
    lens2_bias: 1.913252
    lens3_bias: 2.100644
    lens4_bias: 2.293210
    lens0_alphaz: 0.0
    lens1_alphaz: 0.0
    lens2_alphaz: 0.0
    lens3_alphaz: 0.0
    lens4_alphaz: 0.0
    lens0_z_piv: 0.0
    lens1_z_piv: 0.0
    lens2_z_piv: 0.0
    lens3_z_piv: 0.0
    lens4_z_piv: 0.0
    lens0_alphag: 0.0
    lens1_alphag: 0.0
    lens2_alphag: 0.0
    lens3_alphag: 0.0
    lens4_alphag: 0.0
    # Photo-z shifts and stretches for lenses
    lens0_delta_z: 0.0
    lens1_delta_z: 0.0
    lens2_delta_z: 0.0
    lens3_delta_z: 0.0
    lens4_delta_z: 0.0
    lens0_sigma_z: 1.0
    lens1_sigma_z: 1.0
    lens2_sigma_z: 1.0
    lens3_sigma_z: 1.0
    lens4_sigma_z: 1.0

# which systematics to include in the Firecrown (factory) likelihoods
Firecrown_Factory:
    TwoPointFactory:
        correlation_space: harmonic
        number_counts_factories:
            - type_source: default
              global_systematics: []
              include_rsd: false
              per_bin_systematics:
                -  {type: PhotoZShiftandStretchFactory}
                -  {type: LinearBiasSystematicFactory}
        weak_lensing_factories:
            - type_source: default
              global_systematics:
                - {type: LinearAlignmentSystematicFactory, alphag: 1}
              per_bin_systematics:
                - {type: MultiplicativeShearBiasFactory}
                - {type: PhotoZShiftFactory}
        cmb_factories: []
        int_options: null
                
# - {type: TattAlignmentSystematicFactory, include_z_dependence: true}

sources:  # Sources
    nbins : 5
    ndens : 10  # in arcmin^-2 (it should be a scalar with the total number density or a list with each bin's)
    ellipticity_error : 0.26
    
    # Nz_type : 'SourceSRD2018'  # For now, this is the assumed N(z) for sources -- check SRD 2018
    # Nz_kwargs :  # keyword arguments for SourceSRD2018 class -- can allow easy generalizations for the future
       # Nz_alpha : 0.78
       # Nz_z0 : 0.13
       # Nz_sigmaz : 0.05
    Nz_type : 'ZDistFromFile'
    Nz_kwargs : 
        input_file : "{{ env['AUGUR_DIR'] }}/data/srd_source_bins_y1.txt"
        format : 'ascii'
        # input_file : 'data/srd_source_bins_year_1.npy'

lenses :  # Lenses
    nbins : 5
    ndens : 18  # in arcmin^-2, same convention as for sources
    Nz_type : 'ZDistFromFile'
    Nz_kwargs : 
        input_file : "{{ env['AUGUR_DIR'] }}/data/srd_lens_bins_y1.txt"
        format : 'ascii'
        # input_file : 'data/srd_lens_bins_year_1.npy'
    # Nz_type : 'LensSRD2018'  # For now, this is the assumed N(z) for lenses -- check SRD 2018
    # Nz_kwargs :  # keyword arguments for LensSRD2018 class -- can allow easy generalizations for the future
    #     Nz_width : 0.2  # Photo-z bin-width
    #     Nz_center : np.arange(1, 6)*0.2 + 0.1  # Photo-z bin centers (it can be a list of values or some np array)
    #     Nz_sigmaz : 0.03  # Sigma of photo-z Gaussian smearing
    #     Nz_alpha : 0.94  # N(z) alpha parameter
    #     Nz_z0 : 0.26  # N(z) z-pivot

statistics:
    galaxy_shear_cl_ee : 
        tracer_combs :  [[0, 0], [0, 1], [0, 2], [0, 3], [0, 4], 
                  [1, 1], [1, 2], [1, 3], [1, 4],
                  [2, 2], [2, 3], [2, 4],
                  [3, 3], [3, 4],
                  [4, 4]]
        ell_edges : np.geomspace(20, 15000, 21, endpoint=True)
        kmax : None
    galaxy_shearDensity_cl_e : 
        tracer_combs : [[0, 2], [0, 3], [0, 4], [1, 3], [1, 4], [2, 4], [3, 4]]
        ell_edges : np.geomspace(20, 15000, 21, endpoint=True)
        kmax : 0.202
    galaxy_density_cl :  # The statistics are supposed to be SACC statistics
        tracer_combs : [[0, 0], [1, 1], [2, 2], [3, 3], [4, 4]]  # These need to be lists for now
        ell_edges : np.geomspace(20, 15000, 21, endpoint=True)  # bandpower edges
        kmax : 0.202  # scale cut (in Mpc^-1), 0.3 h/Mpc in SRD
        # kmax : None

cov_options:
    # Several options implemented -- Gaussian internal
    #cov_type : 'gaus_internal'
    #fsky : 0.3
    # ------
    # Or you can also get it from a file
    cov_type : 'SRD'
    SRD_cov_path : "{{ env['AUGUR_DIR'] }}/data/Y1_3x2_SRD_cov.npy"
    # Or using TJPCov
    #cov_type : 'tjpcov'
    #IA : 0.0
    #fsky: 0.3
    #binning_info : 
    #    ell_edges : np.geomspace(20, 15000, 21, endpoint=True).astype(np.int32)

fisher:
    #var_pars: ['Omega_c', 'sigma8', 'n_s', 'Omega_b', 'h', 'lens0_bias', 'lens1_bias', 'mg_musigma_mu', 'mg_musigma_sigma'] 
               #'lens2_bias', 'lens3_bias', 'lens4_bias', 'ia_bias', 'alphaz',
               #'src0_mult_bias', 'src1_mult_bias', 'src2_mult_bias', 'src3_mult_bias', 'src4_mult_bias',
               #'lens0_sigma_z', 'lens1_sigma_z', 'lens2_sigma_z', 'lens3_sigma_z', 'lens4_sigma_z',
               #'lens0_delta_z', 'lens1_delta_z', 'lens2_delta_z', 'lens3_delta_z', 'lens4_delta_z',
               #'src0_delta_z', 'src1_delta_z', 'src2_delta_z', 'src3_delta_z', 'src4_delta_z']
    parameters:  # These uniform "priors" are useful for defining normalized step sizes 
        Omega_c: [0.1, 0.26, 0.9]
    #     A_s: [1e-9, 4e-9]
        sigma8: [0.4, 0.81, 1.2]
    #     w0: [-1.8, -1.0, -0.2]
    #     wa: [-4, 0.0, 0.5]
        h: [0.5, 0.6727, 0.8]
        Omega_b: [0.01, 0.022, 0.05]
        n_s: [0.9, 0.9645, 1.0]
        # lens0_bias: [1.0, 1.562362, 3.0]
        # lens1_bias: [1.0, 1.732963, 3.0]
        mg_musigma_mu: [-2.0, 0.0, 2.0]
        mg_musigma_sigma: [-2.0, 0.0, 2.0]
        # lens2_bias: [1.0, 2.0, 3
    #     #mult_bias: [-0.1 0.0 0.1]
    step: 0.05
    output: 'output/mg_fisher.dat'
    fid_output: 'output/mg_fiducials.dat'
    #transform_Omega_m: True
    #transform_S8: True
    derivative_method: 'numdifftools'
    #derivative_method: 'derivkit'
    #derivative_args: # args for derivkit
    #  method: 'finite'
    #  n_workers: 1
    #  n_points: 27
    #  spacing: '1%'
    #  base_abs: 1.e-3
    #  ridge: 1.e-8

    fisher_bias:
        biased_dv: ''  # Path to file containing modified data vector with the systematic shift to probe
                    # If the file is provided it should be a FITS or ASCII file with the  same binning as the
                    # fiducial data vector and the column dv_sys
        bias_params: 
            mg_musigma_mu: 0.2
        
postprocess:
  latex_table: output/latex_table.tex
  triangle_plot: output/triangle_plot.pdf
  facecolor: blue
  pairplots: [(w0, wa), (Omega_m, S8)]
  outdir: 'output/'
  CL: 
    - 0.68
    - 0.95
